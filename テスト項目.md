### 簡易テストケース

## A. 初期起動・UI要素の表示確認

### 1. アプリ起動

- ウィンドウが表示され、地図（`map.svg`）が5枚横に連続してレンダリングされている
- ツールバーに「追加モード」「編集モード」ボタンがあり、OFF表示になっている
- 右側に「保存」「読み込み」ボタンあり
- 下部に「スライダー」および「現在の年」が表示されている
- 左のサイドバーに「イベント一覧」がある

## 2. 設定ダイアログ確認

- 「設定」ボタンを押すとモーダルが開く
- 最小年・最大年・世界名・概要が入力可能
- 「スライダー更新」や「世界情報を保存」でエラーが出ないか

---

## B. 年スライダー・世界情報の基本操作

### 3. 年スライダー

- スライダーをドラッグすると「`currentYear`」が変化し、コンソールに「年が変更されました」と出る  
- 変更後の「年: XXX」が正しく表示される  

### 4. 世界情報の変更

- 設定ダイアログから「`worldName`」「`worldDescription`」を入力 → 「世界情報を保存」
- 画面の左上などに世界名、概要が反映される

---

## C. 追加モード（点・線・面の追加）

### 1. 点の追加

1. 追加モードON → 「`pointTool`」選択
2. 地図上をクリック → 新規ポイント用の編集フォームが表示される
3. 名前・説明・年を入力 → 保存 → ポイントが作成される
4. イベント一覧にポイントが追加される

### 2. 線の追加

1. 追加モードON → 「`lineTool`」選択
2. 地図上を数回クリックして頂点を増やす → 「確定」ボタン押下（`confirmDrawButton`）
3. ライン編集フォームが出る → 名前・説明・年を保存
4. イベント一覧にラインが追加

### 3. 面 (ポリゴン) の追加

1. 追加モードON → 「`polygonTool`」選択
2. 地図上をクリックして3点以上 → 「確定」
3. ポリゴン編集フォームが出る → 名前・説明・年を保存
4. イベント一覧に面が追加

---

## D. 編集モード（各ツール）

### 1. ポイント移動

- 編集モードON → 「`pointMoveTool`」  
- 既存ポイントをクリック → ポイント選択 → Deleteキー押下して削除確認  
- 別のポイントをマウスドラッグして座標移動  
- 再度同ポイントをクリック → 移動後の位置が維持されている  

### 2. ポイント属性編集

- 「`pointAttributeEditTool`」選択  
- 既存ポイントをクリック → 編集フォーム → 名前・説明を変更 → 保存  
- 「イベント一覧」やツールチップに新しい名前が反映されていることを確認  

### 3. ライン属性編集

- 「`lineAttributeEditTool`」選択  
- 既存ラインをクリック → フォームで名称・説明を変更 → 保存  
- イベント一覧やツールチップに変更が反映される  

### 4. ライン頂点編集

- 「`lineVertexEditTool`」選択
- ラインをクリック → 頂点ハンドルが表示される
- **シフト + クリック** で複数頂点を選択 → ドラッグ → 頂点全て移動
- **Deleteキー** で選択頂点を削除 → 頂点数が減るがライン自体が1点未満にならない限り残る
- ラインが1点になってもラインデータは保持しているか（描画はスキップ）
- 空クリック後に再度頂点追加（エッジハンドル）で復活できるか

### 5. ポリゴン属性編集

- 「`polygonAttributeEditTool`」選択
- 既存ポリゴンをクリック → フォーム表示 → 名称・説明を変更 → 保存
- イベント一覧やツールチップに反映されるか

### 6. ポリゴン頂点編集

- 「`polygonVertexEditTool`」選択
- ポリゴンをクリック → 頂点ハンドルが表示される
- **シフト+クリック** で複数頂点選択 → ドラッグ → 全て移動
- **Deleteキー** で選択頂点を削除 → 頂点が1点になってもポリゴンデータは保持（描画は消える）
- エッジハンドルクリック/ドラッグで頂点追加 → 再度2点→3点→描画がポリゴンに戻る

### 7. Deleteキーで単独ポイント削除

- 単頂点(ポイント)を選択 → Deleteキー → `DataStore.removePoint` → イベント一覧からも消える

---

## E. 保存・読み込み

### 1. 保存動作

- 「保存」ボタン押下 → ダイアログでファイル名指定
- JSONファイルが生成され、コンソールに「データの保存が完了しました。」が出る
- 不明なエラーが出ないこと

### 2. 読み込み動作

1. 編集してデータが更新された状態 → 「読み込み」 → 「保存されていない変更があります。続行しますか？」
2. Yesで続行 → 選択したJSONの内容がロードされ、画面に反映
3. 何も選択せずキャンセル → 「データの読み込みがキャンセルされました」と表示

### 3. 読み込み後の整合

- 読み込んだJSONの年範囲(min/max)や世界名がUIに反映されるか
- イベント一覧にロードしたデータのポイント/ライン/ポリゴンが表示される

---

## F. エッジケース

### 1. 最小限テスト

- ポイントを1個だけ追加 → 保存 → 再読み込み → 問題なく表示される
- ラインを2点だけ → Deleteで1点 → ラインが表示消えるが保持される → 頂点を追加 → 復活
- ポリゴンを3点だけ → Deleteで2点 → ライン化される → Deleteで1点 → 描画消えるがオブジェクト保持 → 頂点追加 → 再度2点、3点 → 再びポリゴン表示
- ポリゴンを毎度頂点1個ずつDeleteして空 → オブジェクトがDataStoreごと削除される

### 2. Shift+クリック多用

- ライン頂点を何度もShift+クリックで選択・解除してドラッグ → 頂点移動が想定通りか

### 3. ポイント移動中のDelete

- `pointMoveTool`で単頂点をクリックし、Delete → 削除されるか

### 4. ツールチップ

- ライン/ポリゴンをドラッグした直後、ツールチップが正しい名前・年を表示する
- ポリゴンを年が複数設定されたプロパティ配列付きで保存してある場合に、スライダー移動で年を切り替え → ドラッグしても正しい年がツールチップに出るか

---

## G. 終了

- アプリの終了
- すべての操作を一通り実施した上で、異常終了（クラッシュ）がないか
- Windows/macOSいずれでも正常終了できるか

## **追加テストケース**

### **H. フォーム表示・ドラッグに関するテスト**

1. **属性フォームがクリック位置付近に出るか**  
   - 編集モードにして「ポイント属性編集」ツールを選択し、任意のポイントをクリック。  
   - フォームがクリック周辺に表示されるか確認。  
   - 保存 or キャンセルでフォームが閉じることを確認。

2. **フォームドラッグテスト**  
   - 属性編集フォームを開き、フォーム上部（テキストやボタンではない部分）をドラッグ。  
   - フォームがスムーズにドラッグ移動できるか、変なジャンプが起きないか確認。

3. **別オブジェクトクリック時のフォーム再表示**  
   - あるラインをクリックして属性フォームを開く。  
   - フォームを閉じずに他のライン or ポリゴンをクリック→ 新しいフォームが、クリックした場所の近くに出るか確認。

4. **詳細ウィンドウがクリック位置付近に出るか**  
   - 編集モードOFFで任意のオブジェクトをクリック。  
   - 詳細ウィンドウがマウス位置付近に表示されるか確認。  
   - 「閉じる」ボタンで消えるか確認。

5. **ツールチップとフォームの共存**  
   - フォームが開いた状態で、別のオブジェクトにマウスオーバーするとツールチップが表示されるか確認。  
   - フォームには影響しないか（位置がずれたりしないか）。

### **I. グリッド表示・オブジェクト配置**

1. **グリッド表示ON/OFF**  
   - グリッド切り替えボタンをクリックしてONにする。地図上に緯度経度ラインが描画されるか。  
   - 再度OFFにするとグリッドが消えるか。  
   - 頂点ドラッグ時、グリッドスナップがあれば正しい動作をするか（将来実装の場合）。

2. **横方向無限スクロール**  
   - 地図を右にズームアウトしてドラッグし、東端の先に地図が続いているか確認（複製表示）。  
   - 左端も同様に確認。  
   - ポリゴンなど大きめオブジェクトを配置しても正しく描画されるか。

### **J. 分裂・合邦の挙動（将来拡張）**

1. **分裂**  
   - ラインやポリゴンに対し、「分裂」操作を行い、オブジェクトが２つに分かれるか。  
   - 分裂後に別個の属性を設定し、時間軸の前後でそれぞれが存在するか確認。

2. **合邦**  
   - 複数のポリゴンを合邦操作して1つの大きなポリゴンにできるか。  
   - 合邦後の属性を編集可能か。

### **K. エラーハンドリング**

1. **JSONファイルが不正な場合**  
   - ファイルを読み込んだ際、フォーマットが壊れている→ 「データの解析中にエラーが発生しました」と出るか。  
   - UIにエラーメッセージが表示されるか。

2. **頂点数不正**  
   - ライン/ポリゴン頂点が1個以下になったとき、描画せずに保持しているか。  
   - 頂点数0になった場合に DataStore から削除されるか。

3. **座標値が極端に大きい/小さい**  
   - スライダーなどに影響しないか。  
   - 表示領域外でも保持されるか。
